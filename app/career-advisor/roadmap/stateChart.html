<!DOCTYPE html>
<html lang="en">
<body>
<script src="https://cdn.jsdelivr.net/npm/gojs@3.1.0/release/go-debug.js"></script>
<p>
  This is a minimalist HTML and JavaScript skeleton of the GoJS Sample
  <a href="https://gojs.net/latest/samples/stateChart.html">stateChart.html</a>. It was automatically generated from a button on the sample page,
  and does not contain the full HTML. It is intended as a starting point to adapt for your own usage.
  For many samples, you may need to inspect the
  <a href="https://github.com/NorthwoodsSoftware/GoJS/blob/master/samples/stateChart.html">full source on Github</a>
  and copy other files or scripts.
</p>
<div id="allSampleContent" class="p-4 w-full">
          
            
            

<script id="code">
  function init() {
    myDiagram = new go.Diagram('myDiagramDiv', {
      padding: 12,
      'animationManager.initialAnimationStyle': go.AnimationStyle.None,
      InitialAnimationStarting: e => {
        var animation = e.subject.defaultAnimation;
        animation.easing = go.Animation.EaseOutExpo;
        animation.duration = 800;
        animation.add(e.diagram, 'scale', 0.3, 1);
        animation.add(e.diagram, 'opacity', 0, 1);
      },

      // have mouse wheel events zoom in and out instead of scroll up and down
      'toolManager.mouseWheelBehavior': go.WheelMode.Zoom,
      // support double-click in background creating a new node
      'clickCreatingTool.archetypeNodeData': { text: 'new node' },
      // enable undo & redo
      'undoManager.isEnabled': true
    });

    // when the document is modified, add a "*" to the title and enable the "Save" button
    myDiagram.addDiagramListener('Modified', e => {
      const button = document.getElementById('SaveButton');
      if (button) button.disabled = !myDiagram.isModified;
      const idx = document.title.indexOf('*');
      if (myDiagram.isModified) {
        if (idx < 0) document.title += '*';
      } else {
        if (idx >= 0) document.title = document.title.slice(0, idx);
      }
    });

    const colors = {
      pink: '#facbcb',
      blue: '#b7d8f7',
      green: '#b9e1c8',
      yellow: '#faeb98',
      background: '#e8e8e8'
    };
    const colorsDark = {
      green: '#3fab76',
      yellow: '#f4d90a',
      blue: '#0091ff',
      pink: '#e65257',
      background: '#161616'
    };
    myDiagram.div.style.backgroundColor = colors.background;

    myDiagram.nodeTemplate =
      new go.Node('Auto', {
          isShadowed: true,
          shadowBlur: 0,
          shadowOffset: new go.Point(5, 5),
          shadowColor: 'black'
        })
        .bindTwoWay('location', 'loc', go.Point.parse, go.Point.stringify)
        .add(
          new go.Shape('RoundedRectangle', {
              strokeWidth: 1.5,
              fill: colors.blue,
              portId: '',
              fromLinkable: true, fromLinkableSelfNode: false, fromLinkableDuplicates: true,
              toLinkable: true, toLinkableSelfNode: false, toLinkableDuplicates: true,
              cursor: 'pointer'
            })
            .bind('fill', 'type', type => {
              if (type === 'Start') return colors.green;
              if (type === 'End') return colors.pink;
              return colors.blue;
            })
            .bind('figure', 'type', type => {
              if (type === 'Start' || type === 'End') return 'Circle';
              return 'RoundedRectangle';
            }),
          new go.TextBlock({
              font: 'bold small-caps 11pt helvetica, bold arial, sans-serif',
              shadowVisible: false,
              margin: 8,
              font: 'bold 14px sans-serif',
              stroke: '#333',
              editable: true
            })
            .bindTwoWay('text')
        );

    // unlike the normal selection Adornment, this one includes a Button
    myDiagram.nodeTemplate.selectionAdornmentTemplate =
      new go.Adornment('Spot')
        .add(
          new go.Panel('Auto')
            .add(
              new go.Shape('RoundedRectangle', { fill: null, stroke: colors.pink, strokeWidth: 3 }),
              new go.Placeholder() // a Placeholder sizes itself to the selected Node
            ),

          // the button to create a "next" node, at the top-right corner
          go.GraphObject.build('Button', {
              alignment: go.Spot.TopRight,
              click: addNodeAndLink // this function is defined below
            })
            .add(
              new go.Shape('PlusLine', { width: 6, height: 6 })
            ) // end button
        );

    // clicking the button inserts a new node to the right of the selected node,
    // and adds a link to that new node
    function addNodeAndLink(e, obj) {
      var adornment = obj.part;
      var diagram = e.diagram;
      diagram.startTransaction('Add State');

      // get the node data for which the user clicked the button
      var fromNode = adornment.adornedPart;
      var fromData = fromNode.data;
      // create a new "State" data object, positioned off to the right of the adorned Node
      var toData = { text: 'new' };
      var p = fromNode.location.copy();
      p.x += 200;
      toData.loc = go.Point.stringify(p); // the "loc" property is a string, not a Point object
      // add the new node data to the model
      var model = diagram.model;
      model.addNodeData(toData);

      // create a link data from the old node data to the new node data
      var linkdata = {
        from: model.getKeyForNodeData(fromData), // or just: fromData.id
        to: model.getKeyForNodeData(toData),
        text: 'transition'
      };
      // and add the link data to the model
      model.addLinkData(linkdata);

      // select the new Node
      var newnode = diagram.findNodeForData(toData);
      diagram.select(newnode);
      diagram.commitTransaction('Add State');
      // if the new node is off-screen, scroll the diagram to show the new node
      if (!diagram.viewportBounds.containsRect(newnode.actualBounds)) {
        diagram.commandHandler.scrollToPart(newnode);
      }
    }

    // replace the default Link template in the linkTemplateMap
    myDiagram.linkTemplate =
      new go.Link({
          // shadow options are for the label, not the link itself
          isShadowed: true,
          shadowBlur: 0,
          shadowColor: 'black',
          shadowOffset: new go.Point(2.5, 2.5),

          curve: go.Curve.Bezier,
          curviness: 40,
          adjusting: go.LinkAdjusting.Stretch,
          reshapable: true,
          relinkableFrom: true,
          relinkableTo: true,
          fromShortLength: 8,
          toShortLength: 10
        })
        .bindTwoWay('points')
        .bind('curviness')
        .add(
          // Main shape geometry
          new go.Shape({ strokeWidth: 2, shadowVisible: false, stroke: 'black' })
            .bind('strokeDashArray', 'progress', progress => progress ? [] : [5, 6])
            .bind('opacity', 'progress', progress => progress ? 1 : 0.5),
          // Arrowheads
          new go.Shape({ fromArrow: 'circle', strokeWidth: 1.5, fill: 'white' })
            .bind('opacity', 'progress', progress => progress ? 1 : 0.5),
          new go.Shape({ toArrow: 'standard', stroke: null, scale: 1.5, fill: 'black' })
            .bind('opacity', 'progress', progress => progress ? 1 : 0.5),
          // The link label
          new go.Panel('Auto')
            .add(
              new go.Shape('RoundedRectangle', {
                shadowVisible: true,
                fill: colors.yellow,
                strokeWidth: 0.5
              }),
              new go.TextBlock({
                  font: '9pt helvetica, arial, sans-serif',
                  margin: 1,
                  editable: true, // enable in-place editing
                  text: 'Action' // default text
                })
                .bind('text')
              // editing the text automatically updates the model data
            )
        );

    // read in the JSON data from the "mySavedModel" element
    load();
  }

  // Show the diagram's model in JSON format
  function save() {
    document.getElementById('mySavedModel').value = myDiagram.model.toJson();
    myDiagram.isModified = false;
  }
  function load() {
    myDiagram.model = go.Model.fromJson(document.getElementById('mySavedModel').value);
  }

  window.addEventListener('DOMContentLoaded', init);
</script>

<div id="sample">
  <div id="myDiagramDiv" style="border: solid 1px black; width: 100%; height: 470px; background: whitesmoke"></div>
  <p>This sample creates a state chart to story-board an online shopping experience.</p>
  <p>
    The text is editable for both the <a>Node</a>s and the <a>Link</a>s.
    The user can draw as many links from one <a>Node</a> to another <a>Node</a> as desired.
    To create a new <a>Link</a> start dragging from the edge of a <a>Node</a>.
    The <a>Link</a> s can be reshaped or deleted when selected.
    Double-clicking in the background of the <a>Diagram</a> creates a new node.
    The mouse wheel is set to zoom in and out instead of scroll.
  </p>
  <p>
    This sample customizes the <a>Part.selectionAdornmentTemplate</a> of the node to a template that contains a button.
    The button is positioned to be at the Top-Right corner of the node by being in a Spot Panel with
    its <a>GraphObject.alignment</a> property set to Spot.TopRight.
  </p>
  <p>
    The Button's <a>GraphObject.click</a> method creates a new node data, adds it to the model,
    and creates a link from the original node data to the new node data.
    All of this is done inside a transaction, so that it can be undone by the user
    (Ctrl+Z and Ctrl+Y will undo and redo transactions).
    After the node is created, <a>CommandHandler.scrollToPart</a> is called to try to center it.
  </p>
  <div>
    <div>
      <button id="SaveButton" onclick="save()">Save</button>
      <button onclick="load()">Load</button>
      Diagram Model saved in JSON format:
    </div>
    <textarea id="mySavedModel" style="width: 100%; height: 300px">{ "class": "go.GraphLinksModel",
  "nodeKeyProperty": "id",
  "pointsDigits": 0,
  "nodeDataArray": [
  {"id":-1, "loc":"155 -150", "type":"Start", "text":"Start" },
  {"id":0, "loc":"190 15", "text":"Shopping"},
  {"id":1, "loc":"353 32", "text":"Browse Items"},
  {"id":2, "loc":"353 166", "text":"Search Items"},
  {"id":3, "loc":"552 12", "text":"View Item"},
  {"id":4, "loc":"700 -95", "text":"View Cart"},
  {"id":5, "loc":"660 100", "text":"Update Cart"},
  {"id":6, "loc":"850 20", "text":"Checkout"},
  {"id":-2, "loc":"830 200", "type":"End", "text":"End" }
  ],
  "linkDataArray": [
    { "from": -1, "to": 0, "progress": true, "text": "Visit online store", "curviness": -10 },
    { "from": 0, "to": 1,  "progress": true, "text": "Browse" },
    { "from": 0, "to": 2,  "progress": true, "text": "Use search bar", "curviness": -70 },
    { "from": 1, "to": 2,  "progress": true, "text": "Use search bar" },
    { "from": 2, "to": 3,  "progress": true, "text": "Click item", "curviness": -70 },
    { "from": 2, "to": 2,  "progress": false, "text": "Another search", "curviness": 40 },
    { "from": 1, "to": 3,  "progress": true, "text": "Click item" },
    { "from": 3, "to": 0,  "progress": false, "text": "Not interested", "curviness": -100 },
    { "from": 3, "to": 4,  "progress": true, "text": "Add to cart" },
    { "from": 4, "to": 0,  "progress": false, "text": "More shopping", "curviness": -150 },
    { "from": 4, "to": 5,  "progress": false, "text": "Update needed", "curviness": 70 },
    { "from": 5, "to": 4,  "progress": false, "text": "Update made" },
    { "from": 4, "to": 6,  "progress": true, "text": "Proceed" },
    { "from": 6, "to": 5,  "progress": false, "text": "Update needed"},
    { "from": 6, "to": -2, "progress": true, "text": "Purchase made" }
  ]
}
    </textarea>
  </div>
</div>

          
        </div>
</body>
</html>